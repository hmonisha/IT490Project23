<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>View Book</title>
</head>
<body>
<nav>
    <a href="/home.html">Home</a>
</nav>
<script>
    function writeBook(response) {
        //dejsonify
        let bookText = '{ "book" : ' +
            '{"bookName":"this is book", "img":"https://dictionary.cambridge.org/us/images/thumb/book_noun_001_01679.jpg?version=5.0.303",' +
            '"authors":"Jacob Jones, Jones","publisher":"Jones Publishing","PublishDate":"03/16/2023","Categories":["Science Fiction", "Fantasy"],' +
            '"price": "17.99", "buyLink":"http://www.amazon.com",' +
            '"pageCount":"207","Language":"English","Description":"This is a description that will hopefully be long enough to make this look kind of big and then maybe go multiple lines and truly test stuff. Yeah."}}';

        let ratingText = '{"rating" : 4.5}';
        let reviewsText = '{"reviews":[{"username":"imapotato","text":"This book was horrible!"},{"username":"hiya","text":"This book was AMAZING!"},{"username":"IAmNotMe","text":"This book was decent"}]}'
        const obj = JSON.parse(bookText);
        const ratObj = JSON.parse(ratingText);
        const revObj = JSON.parse(reviewsText);

        let userHasRating = false;

        let book = obj.book;
        let rating = ratObj.rating;
        let reviews = revObj.reviews;
        if (reviews == ""){
        reviews = [];
    }
    document.write("<h1>" + book.bookName + "</h1>\n" +
        "<img src=\""+book.img+"\" alt=\"\" width=\"165\" height=\"165\" />\n" +
        "<p>Author(s): "+book.authors+"&nbsp;&nbsp;&nbsp;&nbsp;Publisher: "+book.publisher+" &nbsp;&nbsp;&nbsp;&nbsp;Publish Date:"+book.PublishDate+"</p>\n" +
        "<p>Categories: "+book.Categories.toString()+" &nbsp;&nbsp;&nbsp;&nbsp;Page Count:"+book.pageCount+" &nbsp;&nbsp;&nbsp;&nbsp;Language: "+book.Language+"</p>\n" +
        "<p>Description:"+book.Description+"</p>\n" +
        "<p>Price: "+book.price+" <a href="+book.buyLink+">Buy From Amazon</a></p>");

        if(!userHasRating){
            document.write('<br><label for="rating">Rating  </label><select name=""rating" id="rating">'+
                '<option value="0.5">0.5</option>'+
                '<option value="0.5">1.0</option>'+
                '<option value="0.5">1.5</option>'+
                '<option value="0.5">2.0</option>'+
                '<option value="0.5">2.5</option>'+
                '<option value="0.5">3.0</option>'+
                '<option value="3.5">3.5</option>'+
                '<option value="4.0">4.0</option>'+
                '<option value="4.5">4.5</option>'+
                '<option value="5.0">5.0</option></select><button action=""');
        } else {
            document.write("You rated this book " + rating + " out of 5.");
            document.write('<br>');
        }

        for (let i = 0; i<reviews.length; i++) {
            document.write('<h5>'+reviews[i].username+'</h5>'+
            '<br>'+reviews[i].text+'<br><hr />');

        }

        }

        writeBook("");
</script>
</body>
</html>